var m=(o,i,t)=>new Promise((s,c)=>{var a=l=>{try{e(t.next(l))}catch(_){c(_)}},n=l=>{try{e(t.throw(l))}catch(_){c(_)}},e=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,n);e((t=t.apply(o,i)).next())});import{f as S,_ as b,v as g,cd as k,x as N,aD as T,o as d,c as r,b as B,r as h,n as C,e as u,l as p,L as $,bC as A,ce as G,aH as H,w as f,F as y,z as v,t as w}from"./f814164b.js";import{G as L}from"./a45cd8ea.js";const I={class:"gupo-infinite-scroll__content"},V={key:0,class:"gupo-infinite-scroll__loading"},E={key:0,class:"default-loading"},F=S({name:"GupoInfiniteScroll"}),z=Object.assign(F,{props:{width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"100%"},distance:{type:Number,default:0},delay:{type:Number,default:200},load:{type:Function,default:()=>{}},showLoading:{type:Boolean,default:!1}},setup(o){const i=o,t=g(),s=g(!1),c=!!k().loading;let a;const n=e=>m(this,null,function*(){s.value||a||e.target.scrollTop>=e.target.scrollHeight-e.target.clientHeight-i.distance&&(s.value=!0,i.distance===0&&i.showLoading&&(yield H(),e.target.scrollTop+=e.target.querySelector(".gupo-infinite-scroll__loading").clientHeight),yield i.load(),s.value=!1,a=setTimeout(()=>{clearTimeout(a),a=null},i.delay))});return N(()=>{t.value.addEventListener("scroll",n)}),T(()=>{t.value.removeEventListener("scroll",n)}),(e,l)=>(d(),r("div",{class:"gupo-infinite-scroll global-scrollbar",style:G({width:typeof o.width=="string"?o.width:o.width+"px",height:typeof o.height=="string"?o.height:o.height+"px"}),ref_key:"infiniteScrollRef",ref:t},[B("div",I,[h(e.$slots,"default",{},void 0,!0),o.showLoading&&s.value?(d(),r("div",V,[c?h(e.$slots,"loading",{key:1},void 0,!0):(d(),r("div",E,[C("\u52A0\u8F7D\u4E2D"),u(p($))]))])):A("",!0),h(e.$slots,"append",{},void 0,!0)])],4))}}),x=b(z,[["__scopeId","data-v-2c127be1"]]);const D={class:"infinite-scroll container"},O={__name:"index",setup(o){const i=g(new Array(10).fill(0).map((a,n)=>n+1)),t=g(new Array(10).fill(0).map((a,n)=>n+1)),s=()=>{i.value.push(...new Array(10).fill(0).map((a,n)=>i.value.length+n+1))},c=()=>new Promise(a=>{setTimeout(()=>{t.value.push(...new Array(10).fill(0).map((n,e)=>t.value.length+e+1)),t.value,a()},1e3)});return(a,n)=>(d(),r("div",D,[u(L,{title:"\u9ED8\u8BA4"},{default:f(()=>[u(x,{height:400,load:s},{default:f(()=>[(d(!0),r(y,null,v(p(i),(e,l)=>(d(),r("p",{key:l},w(e),1))),128))]),_:1})]),_:1}),u(L,{title:"\u5F02\u6B65\u8BF7\u6C42 Loading"},{default:f(()=>[u(x,{height:400,load:c,showLoading:!0},{default:f(()=>[(d(!0),r(y,null,v(p(t),(e,l)=>(d(),r("p",{key:l},w(e),1))),128))]),_:1})]),_:1})]))}},M=b(O,[["__scopeId","data-v-402d006d"]]);export{M as default};
