var _e=Object.defineProperty,Oe=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ae=(e,a,n)=>a in e?_e(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,v=(e,a)=>{for(var n in a||(a={}))ke.call(a,n)&&ae(e,n,a[n]);if(ne)for(var n of ne(a))Ce.call(a,n)&&ae(e,n,a[n]);return e},x=(e,a)=>Oe(e,ve(a));var le=(e,a,n)=>new Promise((t,i)=>{var c=o=>{try{C(n.next(o))}catch(m){i(m)}},k=o=>{try{C(n.throw(o))}catch(m){i(m)}},C=o=>o.done?t(o.value):Promise.resolve(o.value).then(c,k);C((n=n.apply(e,a)).next())});import{au as Se,ah as we,ai as $e,cs as Ae,c0 as je,ad as Re,c6 as Fe,ct as Te,e as d,A as fe,h as T,q as I,V as U,o as f,c as O,w as r,b as h,l as s,n as j,F as J,z as pe,t as V,s as H,cu as De,cv as Pe,f as me,v as z,x as ge,cw as B,aD as Be,cn as se,D as E,cx as ze,cy as Ne,bC as D,cz as Ee,cA as Le,_ as xe,m as Ie,r as _,G as oe,bt as re,bu as ie,cB as He,bA as Ve,bz as Ge}from"./51302e18.js";import{C as q}from"./bcb17ec8.js";import{c as ce}from"./8e804c7a.js";import{_ as Ke}from"./7293171d.js";import{G as Me}from"./ecb9bcb5.js";var qe="[object Map]",Ue="[object Set]",Je=Object.prototype,Qe=Je.hasOwnProperty;function We(e){if(e==null)return!0;if(Se(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||$e(e)||Ae(e)||je(e)))return!e.length;var a=Re(e);if(a==qe||a==Ue)return!e.size;if(Fe(e))return!Te(e).length;for(var n in e)if(Qe.call(e,n))return!1;return!0}var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};const Ye=Xe;function ue(e){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?Object(arguments[a]):{},t=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),t.forEach(function(i){Ze(e,i,n[i])})}return e}function Ze(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var W=function(a,n){var t=ue({},a,n.attrs);return d(fe,ue({},t,{icon:Ye}),null)};W.displayName="ColumnHeightOutlined";W.inheritAttrs=!1;const et=W;var tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};const nt=tt;function de(e){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?Object(arguments[a]):{},t=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),t.forEach(function(i){at(e,i,n[i])})}return e}function at(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var X=function(a,n){var t=de({},a,n.attrs);return d(fe,de({},t,{icon:nt}),null)};X.displayName="ReloadOutlined";X.inheritAttrs=!1;const lt=X,st=[{name:"\u9ED8\u8BA4",key:"default"},{name:"\u4E2D\u7B49",key:"middle"},{name:"\u7D27\u51D1",key:"small"}],Q={operation:{type:Array,default:()=>["size","fullscreen","reload","setting"]},size:{type:String,default:"default"},columns:{type:Array,default:()=>[],require:!0},fullscreenEl:Object};const ot={class:"column-setting"},rt={class:"column-setting-popover-title"},it={class:"column-setting-popover-group-box"},ct={__name:"ColumnSetting",props:{options:{type:Array,default:()=>[]}},emits:["change"],setup(e,{emit:a}){const n=e,t=T(()=>n.options),i={indeterminate:!1,checkAll:!0,checkedList:t.value},c=I(v({},i)),k=o=>{Object.assign(c,{checkedList:o.target.checked?t.value:[],indeterminate:!1})};U(()=>c.checkedList,o=>{c.indeterminate=!!o.length&&o.length<t.value.length,c.checkAll=o.length===t.value.length});const C=()=>{const{indeterminate:o,checkAll:m,checkedList:g}=i;c.indeterminate=o,c.checkAll=m,c.checkedList=g};return U(()=>c.checkedList,()=>{a("change",c.checkedList)}),(o,m)=>(f(),O("div",ot,[d(s(Pe),{trigger:"click",placement:"bottomRight"},{title:r(()=>[h("div",rt,[d(s(q),{checked:c.checkAll,"onUpdate:checked":m[0]||(m[0]=g=>c.checkAll=g),indeterminate:c.indeterminate,onChange:k},{default:r(()=>[j(" \u5217\u5C55\u793A ")]),_:1},8,["checked","indeterminate"]),h("span",{class:"global-master-color",onClick:C},"\u91CD\u7F6E")])]),content:r(()=>[h("div",it,[d(s(q).Group,{value:c.checkedList,"onUpdate:value":m[1]||(m[1]=g=>c.checkedList=g)},{default:r(()=>[(f(!0),O(J,null,pe(s(t),(g,R)=>(f(),O("div",{class:"check-option",key:R},[d(s(q),{value:g},{default:r(()=>[j(V(g),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["value"])])]),default:r(()=>[d(s(H),null,{title:r(()=>[j("\u5217\u8BBE\u7F6E")]),default:r(()=>[d(s(De))]),_:1})]),_:1})]))}};const ut={key:0,class:"globalTableOperation-icon"},dt={key:3,class:"globalTableOperation-icon"},ft=me({name:"GlobalTableOptions"}),pt=Object.assign(ft,{props:v({},Q),emits:["refresh","setDefineColumns"],setup(e,{expose:a,emit:n}){const t=e,i=z(t.size),c=({key:p})=>{i.value=p},k=z(!1),C=()=>{B.toggle(t.fullscreenEl||document.getElementById("main")||document.body)},o=()=>{k.value=B.isFullscreen};ge(()=>{B.isEnabled&&B.on("change",o)}),Be(()=>{B.isEnabled&&B.off("change",o)});const m=T(()=>t.columns.map(p=>p.title)),g=z(!0),R=p=>{g.value=!!p.length,p.length&&n("setDefineColumns",t.columns.filter(P=>p.includes(P.title)))};return a({density:i,hasColumns:g}),(p,P)=>(f(),O(J,null,[p.operation.includes("size")?(f(),O("div",ut,[d(s(Ne),{trigger:["click"],overlayClassName:"density"},{overlay:r(()=>[d(s(se),{onClick:c},{default:r(()=>[(f(!0),O(J,null,pe(s(st),A=>(f(),E(s(se).Item,{key:A.key,class:ze({active:i.value===A.key})},{default:r(()=>[h("span",null,V(A.name),1)]),_:2},1032,["class"]))),128))]),_:1})]),default:r(()=>[d(s(H),null,{title:r(()=>[j("\u5BC6\u5EA6")]),default:r(()=>[d(s(et))]),_:1})]),_:1})])):D("",!0),p.operation.includes("fullscreen")?(f(),O("div",{key:1,class:"globalTableOperation-icon",onClick:C},[d(s(H),null,{title:r(()=>[j("\u653E\u5927")]),default:r(()=>[k.value?(f(),E(s(Ee),{key:0})):(f(),E(s(Le),{key:1}))]),_:1})])):D("",!0),p.operation.includes("reload")?(f(),O("div",{key:2,class:"globalTableOperation-icon",onClick:P[0]||(P[0]=A=>p.$emit("refresh"))},[d(s(H),null,{title:r(()=>[j("\u5237\u65B0")]),default:r(()=>[d(s(lt))]),_:1})])):D("",!0),p.operation.includes("setting")?(f(),O("div",dt,[d(ct,{options:s(m),onChange:R},null,8,["options"])])):D("",!0)],64))}});const mt={key:0,class:"top-area"},gt={class:"left"},yt={class:"right"},ht={class:"selected"},bt={class:"selected-left"},_t={class:"selected-num"},Ot={class:"global-master-color"},vt={class:"tip"},kt={class:"selected-right"},Ct={id:"global-table"},St=me({name:"GlobalTable"}),wt=Object.assign(St,{props:x(v({},Q),{isTopOperation:{type:Boolean,default:!0},tableTitle:{type:String,default:""},listApi:{type:Function,require:!0},pageNames:{type:Object,default:()=>({page:"page",size:"per_page"})},pageData:{},listApiParamsName:{type:Object,default:()=>({list:"list",paginate:"paginate",total:"total"})},sortNames:{type:Object,default:()=>({sortField:"",sortOrder:"",defaultField:"",defaultOrder:""})},sortOrder:{type:Object,default:()=>({ascend:"asc",descend:"desc"})},pagination:{type:[Object,Boolean],default:()=>({})},rowSelection:{type:[Object,Boolean],default:()=>!1},hiddenRowSelectionArea:{type:Boolean,default:!1},hiddenCancelSelected:{type:Boolean,default:!1},expandedRowRender:{type:Boolean,default:!1},customFilterIcon:{type:Boolean,default:!1},title:{type:Boolean,default:!1},footer:{type:Boolean,default:!1},emptyText:{type:Boolean,default:!1},summary:{type:Boolean,default:!1},customFilterDropdown:{type:Boolean,default:!1},operationRender:{type:[Object,Function]}}),emits:["change","selectChange","selectedCancel"],setup(e,{expose:a,emit:n}){var te;const t=e,i=Ie(),c=z(),k=z(),C={current_page:1,per_page:((te=t==null?void 0:t.pagination)==null?void 0:te.defaultPageSize)||10};let o=I(v({},C));ge(()=>{G()});const m=(l,u,S)=>{const{current:F,pageSize:$}=l;o.current_page=F,o.per_page=$,G(S,u),n("change",{data:l,filters:u,sorter:S})},g=l=>{if(l)w.dataSource.length===1&&o.current_page>1&&(o.current_page-=1);else{const{current_page:u}=C;o.current_page=u}G()},R=z(ce(t.columns));U(()=>t.columns,()=>{R.value=ce(t.columns)});const p=T(()=>R.value.map(l=>x(v({},l),{dataIndex:(l==null?void 0:l.dataIndex)||l.key,customRender:l.customRender||(({text:u,record:S})=>(typeof u=="object"?We(u):u==="")?"\u2014":l.setValue?l.setValue(u,S):u)}))),P=l=>{R.value=l},A=I({rowKeys:[],loading:!1}),Y=l=>{A.rowKeys=l,n("selectChange",l)},ye=T(()=>{var l;return((l=L.value)==null?void 0:l.selectedRowKeys.length)>0&&!t.hiddenRowSelectionArea}),Z=()=>{A.rowKeys=[],n("selectChange",[]),n("selectedCancel")},w=I({dataSource:[],total:0,loading:!1}),G=(l,u)=>le(this,null,function*(){var N;const S=l||{field:t.sortNames.defaultField,order:t.sortNames.defaultOrder};w.loading=!0;const F=yield t.listApi(v(v({[t.pageNames.page]:o.current_page,[t.pageNames.size]:o.per_page},t.sortNames.sortField&&{[t.sortNames.sortField]:S.field,[t.sortNames.sortOrder]:t.sortOrder[S.order]}),u)).finally(()=>{w.loading=!1}),{data:$}=F;w.dataSource=$[t.listApiParamsName.list].map((y,b)=>v({key:b},y)),w.total=(N=$==null?void 0:$[t.listApiParamsName.paginate])==null?void 0:N[t.listApiParamsName.total]}),he=T(()=>t.pagination?x(v({total:w.total,current:o.current_page,defaultPageSize:o.per_page,showTotal:l=>`\u603B\u8BA1${l}\u6761`,"show-quick-jumper":!0},t.pagination),{pageSizeOptions:["10","20","50","100","9999"]}):t.pagination),L=T(()=>t.rowSelection?v({selectedRowKeys:A.rowKeys,onChange:Y},t.rowSelection):void 0),ee=T(()=>w.dataSource.filter(l=>{var u;return(u=L.value)==null?void 0:u.selectedRowKeys.includes(l[t.rowKey])}));return a({refresh:g,selectedDataSource:ee,selectedChange:Y}),(l,u)=>{var S,F,$,N;return f(),O("div",{class:"global-table",ref_key:"$globalTable",ref:c},[e.isTopOperation?(f(),O("div",mt,[h("div",gt,V(e.tableTitle||`${s(i).meta.title||""}\u5217\u8868`),1),h("div",yt,[_(l.$slots,"operation",{},()=>[(f(),E(Ge(t.operationRender)))],!0),l.operation.length?(f(),E(s(Me),{key:0,type:"vertical"})):D("",!0),d(pt,oe(Object.keys(s(Q)).reduce((y,b)=>Object.assign(y,{[b]:t[b]}),{}),{ref_key:"$globalTableOptions",ref:k,fullscreenEl:l.fullscreenEl||c.value,onSetDefineColumns:u[0]||(u[0]=y=>P(y)),onRefresh:u[1]||(u[1]=y=>g(!0))}),null,16,["fullscreenEl"])])])):D("",!0),re(h("div",ht,[h("div",bt,[d(s(He)),h("span",_t,[j(" \u5DF2\u9009\u62E9 "),h("span",Ot,V((F=(S=s(L))==null?void 0:S.selectedRowKeys)==null?void 0:F.length),1),j(" \u9879 ")]),h("span",vt,[_(l.$slots,"selected-tip",{},void 0,!0)])]),h("div",kt,[e.hiddenCancelSelected?D("",!0):(f(),O("span",{key:0,class:"global-master-color",onClick:Z},"\u53D6\u6D88\u9009\u62E9")),_(l.$slots,"selected-operation",{selectedCancel:Z,item:s(ee)},void 0,!0)])],512),[[ie,s(ye)]]),h("div",Ct,[re(d(s(Ke),oe(l.$attrs,{"row-selection":s(L),dataSource:w.dataSource,columns:s(p),pagination:s(he),onChange:m,size:($=k.value)==null?void 0:$.density,loading:w.loading}),Ve({headerCell:r(({title:y,column:b})=>[_(l.$slots,"headerCell",{column:b,title:y},void 0,!0)]),bodyCell:r(({text:y,record:b,index:K,column:M})=>[_(l.$slots,"bodyCell",{column:M,text:y,index:K,record:b},void 0,!0)]),_:2},[e.title?{name:"title",fn:r(()=>[_(l.$slots,"title",{},void 0,!0)]),key:"0"}:void 0,e.footer?{name:"footer",fn:r(()=>[_(l.$slots,"footer",{},void 0,!0)]),key:"1"}:void 0,e.summary?{name:"summary",fn:r(()=>[_(l.$slots,"summary",{},void 0,!0)]),key:"2"}:void 0,e.emptyText?{name:"emptyText",fn:r(()=>[_(l.$slots,"emptyText",{},void 0,!0)]),key:"3"}:void 0,e.expandedRowRender?{name:"expandedRowRender",fn:r(()=>[_(l.$slots,"expandedRowRender",{},void 0,!0)]),key:"4"}:void 0,e.customFilterDropdown?{name:"customFilterDropdown",fn:r(({setSelectedKeys:y,selectedKeys:b,confirm:K,clearFilters:M,column:be})=>[_(l.$slots,"customFilterDropdown",{setSelectedKeys:y,selectedKeys:b,confirm:K,clearFilters:M,column:be},void 0,!0)]),key:"5"}:void 0,e.customFilterIcon?{name:"customFilterIcon",fn:r(({filtered:y,column:b})=>[_(l.$slots,"customFilterIcon",{filtered:y,column:b},void 0,!0)]),key:"6"}:void 0]),1040,["row-selection","dataSource","columns","pagination","size","loading"]),[[ie,(N=k.value)==null?void 0:N.hasColumns]])])],512)}}}),Dt=xe(wt,[["__scopeId","data-v-83078af1"]]);export{Dt as G};
